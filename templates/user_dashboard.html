{% include 'navbar.html' %}

<div class="container mt-4">
    <h1 class="mb-3">Prehabilitation</h1>
    <p class="text-muted mb-4">Please complete the following questionnaire in order to comprehensively assess your health status</p>

    <div class="row g-4">
        <!-- DASI 问卷卡片 - 始终可用 -->
        <div class="col-md-4">
            <div class="card h-100 shadow">
                <div class="card-body">
                    <h5 class="card-title">Physical Activity</h5>
                    <p class="card-text text-muted">Assess daily activity ability and functional status</p>
                    <button class="btn btn-primary w-100"
                            onclick="startQuestionnaire('dasi')">
                        Start
                    </button>
                </div>
            </div>
        </div>

        <!-- PHQ-4 问卷卡片 - 永久禁用 -->
        <div class="col-md-4">
            <div class="card h-100 shadow">
                <div class="card-body">
                    <h5 class="card-title">Psychological Wellbeing</h5>
                    <p class="card-text text-muted">Assess recent emotional and anxiety states</p>
                    <button class="btn btn-primary w-100"
                            disabled
                            onclick="startQuestionnaire('phq4')">
                        Start
                    </button>
                </div>
            </div>
        </div>

        <!-- PG-SGA 问卷卡片 - 永久禁用 -->
        <div class="col-md-4">
            <div class="card h-100 shadow">
                <div class="card-body">
                    <h5 class="card-title">Nutrition</h5>
                    <p class="card-text text-muted">Assess nutritional status and daily activity ability</p>
                    <button class="btn btn-primary w-100"
                            disabled
                            onclick="startQuestionnaire('pgsga')">
                        Start
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function startQuestionnaire(type) {
        // 清除所有问卷进度数据，确保每次从DASI开始都是全新流程
        if (type === 'dasi') {
            ['dasi_answers', 'phq4_answers', 'pgsga_answers', 'questionnaire_progress'].forEach(key => {
                localStorage.removeItem(key);
            });
        }
        window.location.href = `/user/questionnaires/${type}`;
    }
</script>

<!-- 引入 Bootstrap JS 依赖 -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">

<!-- 新增：资源推荐区域 -->
<div class="container mt-5">
    <h2 class="mb-4">Recommended Resources</h2>
    <div class="row g-4">

        <!-- NHS 资源卡片 -->
        <div class="col-md-4">
            <a href="https://www.prehab.nhs.scot/" target="_blank" class="text-decoration-none">
                <div class="card h-100 shadow position-relative overflow-hidden">
                    <img src="{{ url_for('static', filename='images/NHS.png') }}" class="card-img-top" alt="NHS Image">
                    <div class="position-absolute bottom-0 w-100 bg-dark bg-opacity-50 text-white p-2">
                        <small>Prehabilitation for Scotland</small>
                    </div>
                </div>
            </a>
        </div>

        <!-- Maggie's 资源卡片 -->
        <div class="col-md-4">
            <a href="https://www.maggies.org/" target="_blank" class="text-decoration-none">
                <div class="card h-100 shadow position-relative overflow-hidden">
                    <img src="{{ url_for('static', filename='images/maggies.png') }}" class="card-img-top" alt="maggies">
                    <div class="position-absolute bottom-0 w-100 bg-dark bg-opacity-50 text-white p-2">
                        <small>Prehabilitation information and workshop at Maggie's</small>
                    </div>
                </div>
            </a>
        </div>

        <!-- Macmillan 资源卡片 -->
        <div class="col-md-4">
            <a href="https://www.macmillan.org.uk/" target="_blank" class="text-decoration-none">
                <div class="card h-100 shadow position-relative overflow-hidden">
                    <img src="{{ url_for('static', filename='images/macmillan.png') }}" class="card-img-top" alt="Macmillan">
                    <div class="position-absolute bottom-0 w-100 bg-dark bg-opacity-50 text-white p-2">
                        <small>Macmillan One to One Team</small>
                    </div>
                </div>
            </a>
        </div>

    </div>
</div>